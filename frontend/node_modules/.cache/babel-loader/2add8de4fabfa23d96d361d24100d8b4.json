{"ast":null,"code":"import React from\"react\";import ReactDOM from\"react-dom\";import Root from\"./components/root\";import configureStore from'./store/store';import jwt_decode from'jwt-decode';import{setAuthToken}from'./util/session_api_util';import{logout}from'./actions/session_actions';// import * as apiUtil from \"./util/session_api_util.js\"\n// used for testing\ndocument.addEventListener(\"DOMContentLoaded\",function(){var root=document.getElementById(\"root\");var store;if(localStorage.jwtToken){setAuthToken(localStorage.jwtToken);var decodedUser=jwt_decode(localStorage.jwtToken);var preloadedState={session:{isAuthenticated:true,user:decodedUser}};store=configureStore(preloadedState);var currentTime=Date.now()/1000;if(decodedUser.exp<currentTime){store.dispatch(logout());window.location.href='/#/login';}}else{store=configureStore();}// TESTING START\nwindow.getState=store.getState;// window.dispatch = store.dispatch;\n// window.logout\nwindow.store=store;// TESTING END\nReactDOM.render(/*#__PURE__*/React.createElement(Root,{store:store}),root);});","map":{"version":3,"sources":["/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/src/index.js"],"names":["React","ReactDOM","Root","configureStore","jwt_decode","setAuthToken","logout","document","addEventListener","root","getElementById","store","localStorage","jwtToken","decodedUser","preloadedState","session","isAuthenticated","user","currentTime","Date","now","exp","dispatch","window","location","href","getState","render"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,MAAOC,CAAAA,IAAP,KAAiB,mBAAjB,CACA,MAAOC,CAAAA,cAAP,KAA2B,eAA3B,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CAEA,OAASC,YAAT,KAA6B,yBAA7B,CACA,OAASC,MAAT,KAAuB,2BAAvB,CAEA;AACA;AAEAC,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,CAA8C,UAAM,CAChD,GAAMC,CAAAA,IAAI,CAAGF,QAAQ,CAACG,cAAT,CAAwB,MAAxB,CAAb,CACA,GAAIC,CAAAA,KAAJ,CACA,GAAIC,YAAY,CAACC,QAAjB,CAA2B,CACvBR,YAAY,CAACO,YAAY,CAACC,QAAd,CAAZ,CACA,GAAMC,CAAAA,WAAW,CAAGV,UAAU,CAACQ,YAAY,CAACC,QAAd,CAA9B,CACA,GAAME,CAAAA,cAAc,CAAG,CAAEC,OAAO,CAAE,CAAEC,eAAe,CAAE,IAAnB,CAAyBC,IAAI,CAAEJ,WAA/B,CAAX,CAAvB,CAEAH,KAAK,CAAGR,cAAc,CAACY,cAAD,CAAtB,CAEA,GAAMI,CAAAA,WAAW,CAAGC,IAAI,CAACC,GAAL,GAAa,IAAjC,CAEA,GAAIP,WAAW,CAACQ,GAAZ,CAAkBH,WAAtB,CAAmC,CACjCR,KAAK,CAACY,QAAN,CAAejB,MAAM,EAArB,EACAkB,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,UAAvB,CACD,CACJ,CAbD,IAaO,CACHf,KAAK,CAAGR,cAAc,EAAtB,CACH,CAED;AACAqB,MAAM,CAACG,QAAP,CAAkBhB,KAAK,CAACgB,QAAxB,CACA;AACA;AACAH,MAAM,CAACb,KAAP,CAAeA,KAAf,CACA;AAEAV,QAAQ,CAAC2B,MAAT,cAAgB,oBAAC,IAAD,EAAM,KAAK,CAAEjB,KAAb,EAAhB,CAAwCF,IAAxC,EACH,CA5BD","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Root from \"./components/root\"\nimport configureStore from './store/store';\nimport jwt_decode from 'jwt-decode';\n\nimport { setAuthToken } from './util/session_api_util';\nimport { logout } from './actions/session_actions';\n\n// import * as apiUtil from \"./util/session_api_util.js\"\n// used for testing\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const root = document.getElementById(\"root\")\n    let store;\n    if (localStorage.jwtToken) {\n        setAuthToken(localStorage.jwtToken);\n        const decodedUser = jwt_decode(localStorage.jwtToken);\n        const preloadedState = { session: { isAuthenticated: true, user: decodedUser } };\n        \n        store = configureStore(preloadedState);\n    \n        const currentTime = Date.now() / 1000;\n    \n        if (decodedUser.exp < currentTime) {\n          store.dispatch(logout());\n          window.location.href = '/#/login';\n        }\n    } else {\n        store = configureStore()\n    }\n    \n    // TESTING START\n    window.getState = store.getState;\n    // window.dispatch = store.dispatch;\n    // window.logout\n    window.store = store;\n    // TESTING END\n\n    ReactDOM.render(<Root store={store} />, root)\n})"]},"metadata":{},"sourceType":"module"}