{"ast":null,"code":"import _classCallCheck from\"/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import PlayerInfoContainer from'./player_info_container';import{Link}from'react-router-dom';var Player=/*#__PURE__*/function(_React$Component){_inherits(Player,_React$Component);var _super=_createSuper(Player);function Player(props){var _this;_classCallCheck(this,Player);_this=_super.call(this,props);_this.state={play:false,time:0,duration:0,mute:false,repeat:false,shuffle:false};_this.audio=React.createRef();_this.play=_this.play.bind(_assertThisInitialized(_this));_this.handleonPlay=_this.handleonPlay.bind(_assertThisInitialized(_this));_this.pause=_this.pause.bind(_assertThisInitialized(_this));_this.updateTime=_this.updateTime.bind(_assertThisInitialized(_this));_this.parseTime=_this.parseTime.bind(_assertThisInitialized(_this));_this.updateVolume=_this.updateVolume.bind(_assertThisInitialized(_this));_this.volumeBtn=_this.volumeBtn.bind(_assertThisInitialized(_this));_this.toggleMute=_this.toggleMute.bind(_assertThisInitialized(_this));_this.toggleRepeat=_this.toggleRepeat.bind(_assertThisInitialized(_this));_this.nextTrack=_this.nextTrack.bind(_assertThisInitialized(_this));_this.prevTrack=_this.prevTrack.bind(_assertThisInitialized(_this));_this.toggleShuffle=_this.toggleShuffle.bind(_assertThisInitialized(_this));_this.handleEnded=_this.handleEnded.bind(_assertThisInitialized(_this));return _this;}_createClass(Player,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.volume!==this.props.volume){this.audio.volume=this.props.volume;}if(prevProps.currentTrack!==this.props.currentTrack){clearInterval(this.interval);}if(prevProps.currentTrack!==this.props.currentTrack&&this.props.currentTrack===undefined){this.setState({pause:true});this.audio.pause();clearInterval(this.interval);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.interval);this.props.removeEverything();}},{key:\"play\",value:function play(e){e.preventDefault();if(!this.props.currentTrack)return null;this.handleonPlay();this.audio.play();}},{key:\"handleonPlay\",value:function handleonPlay(){var _this2=this;this.setState({play:true});this.audio.volume=this.props.volume;this.interval=setInterval(function(){if(_this2.audio){_this2.setState({time:_this2.audio.currentTime,duration:_this2.audio.duration});}},500);}},{key:\"handleEnded\",value:function handleEnded(){if(this.state.shuffle){this.props.shuffleTracks();}else if(!this.props.nextTrack){this.setState({play:false});this.audio.pause();}else{this.props.nextTrack();}}},{key:\"pause\",value:function pause(e){e.preventDefault();this.setState({play:false});this.audio.pause();}},{key:\"nextTrack\",value:function nextTrack(e){e.preventDefault();this.props.nextTrack();}},{key:\"prevTrack\",value:function prevTrack(e){e.preventDefault();this.props.prevTrack();}},{key:\"updateTime\",value:function updateTime(e){this.audio.currentTime=e.target.value;this.setState({time:e.target.value});}},{key:\"updateVolume\",value:function updateVolume(e){this.props.changeVolume(e.target.value/100);}},{key:\"toggleRepeat\",value:function toggleRepeat(e){var _this3=this;e.preventDefault();this.setState({repeat:!this.state.repeat},function(){_this3.audio.loop=_this3.state.repeat;});}},{key:\"toggleShuffle\",value:function toggleShuffle(e){e.preventDefault();this.setState({shuffle:!this.state.shuffle});}},{key:\"toggleMute\",value:function toggleMute(e){var _this4=this;this.setState({mute:!this.state.mute},function(){if(_this4.props.volume)_this4.prevVolume=_this4.props.volume;if(_this4.state.mute){_this4.props.changeVolume(0);_this4.audio.volume=0;}else{_this4.props.changeVolume(_this4.prevVolume);_this4.audio.volume=_this4.prevVolume;}});}},{key:\"parseTime\",value:function parseTime(time){if(!time)return\"0:00\";var min=Math.floor(time/60);var seconds=Math.floor(time-min*60);if(seconds<10)seconds=\"0\".concat(seconds);return\"\".concat(min,\":\").concat(seconds);}},{key:\"volumeBtn\",value:function volumeBtn(){var button;var volume=this.props.volume;if(volume>=0.5){button=/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-volume-up\"});}else if(volume<0.5&&volume>0){button=/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-volume-down\"});}else{button=/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-volume-mute\"});}return/*#__PURE__*/React.createElement(\"div\",{onClick:this.toggleMute,className:\"p-volume-btn\"},button);}},{key:\"render\",value:function render(){var _this5=this;var playBtn=/*#__PURE__*/React.createElement(\"button\",{className:\"p-button-circle\",onClick:this.play},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-play\"}));var pauseBtn=/*#__PURE__*/React.createElement(\"button\",{className:\"p-button-circle\",onClick:this.pause},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-pause\"}));var shuffling=this.state.shuffle?\"-shuffling\":null;var shuffle=/*#__PURE__*/React.createElement(\"button\",{onClick:this.toggleShuffle,className:\"p-button-shuffle\".concat(shuffling,\" pbtn\")},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-random\"}));var active=this.state.repeat?\"-active\":null;var repeat=/*#__PURE__*/React.createElement(\"button\",{className:\"p-button-repeat\".concat(active,\" pbtn\"),onClick:this.toggleRepeat},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-redo\"}));var prevTrackBtn=/*#__PURE__*/React.createElement(\"button\",{onClick:this.prevTrack,className:\"p-button-prev pbtn\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-step-backward\"}));var nextTrackBtn=/*#__PURE__*/React.createElement(\"button\",{onClick:this.nextTrack,className:\"p-button-fwd pbtn\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-step-forward\"}));var _this$state=this.state,play=_this$state.play,time=_this$state.time,duration=_this$state.duration;var currentTrack=this.props.currentTrack;return/*#__PURE__*/React.createElement(\"div\",{className:\"p-container\"},/*#__PURE__*/React.createElement(PlayerInfoContainer,{shuffle:this.state.shuffle}),/*#__PURE__*/React.createElement(\"div\",{className:\"p-audio-control\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-buttons-container\"},/*#__PURE__*/React.createElement(\"audio\",{src:currentTrack?currentTrack.songUrl:null,ref:function ref(audio){return _this5.audio=audio;},onPlay:this.handleonPlay,onEnded:this.handleEnded,autoPlay:true}),!play&&playBtn,play&&pauseBtn),/*#__PURE__*/React.createElement(\"div\",{className:\"p-timeline-container\"},/*#__PURE__*/React.createElement(\"span\",{className:\"p-current-time\"},this.parseTime(time)),/*#__PURE__*/React.createElement(\"input\",{className:\"p-timeline\",type:\"range\",onChange:this.updateTime,value:time,max:duration}),/*#__PURE__*/React.createElement(\"span\",{className:\"p-duration\"},this.parseTime(duration)))),/*#__PURE__*/React.createElement(\"div\",{className:\"p-volume-container\"},/*#__PURE__*/React.createElement(Link,{to:\"/open/queue\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-queue-list\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-indent\"}))),this.volumeBtn(),/*#__PURE__*/React.createElement(\"input\",{className:\"p-volume\",type:\"range\",onChange:this.updateVolume,value:this.props.volume*100,max:\"100\",style:{backgroundImage:'-webkit-gradient(linear, left top, right top, '+'color-stop('+this.props.volume+', #3c02b0), '+'color-stop('+this.props.volume+', #666666)'+')'}})));}}]);return Player;}(React.Component);export default Player;","map":{"version":3,"sources":["/Users/rishabhgupta/Desktop/281_project/cmpe281_p2/frontend/src/components/player/player.js"],"names":["React","PlayerInfoContainer","Link","Player","props","state","play","time","duration","mute","repeat","shuffle","audio","createRef","bind","handleonPlay","pause","updateTime","parseTime","updateVolume","volumeBtn","toggleMute","toggleRepeat","nextTrack","prevTrack","toggleShuffle","handleEnded","prevProps","volume","currentTrack","clearInterval","interval","undefined","setState","removeEverything","e","preventDefault","setInterval","currentTime","shuffleTracks","target","value","changeVolume","loop","prevVolume","min","Math","floor","seconds","button","playBtn","pauseBtn","shuffling","active","prevTrackBtn","nextTrackBtn","songUrl","backgroundImage","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PlayerInfoContainer from './player_info_container';\nimport { Link } from 'react-router-dom';\n\nclass Player extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            play: false,\n            time: 0,\n            duration: 0,\n            mute: false,\n            repeat: false,\n            shuffle: false,\n        }\n        this.audio = React.createRef();\n        this.play = this.play.bind(this);\n        this.handleonPlay = this.handleonPlay.bind(this);\n        this.pause = this.pause.bind(this);\n        this.updateTime = this.updateTime.bind(this);\n        this.parseTime = this.parseTime.bind(this);\n        this.updateVolume = this.updateVolume.bind(this);\n        this.volumeBtn = this.volumeBtn.bind(this);\n        this.toggleMute = this.toggleMute.bind(this);\n        this.toggleRepeat = this.toggleRepeat.bind(this);\n        this.nextTrack = this.nextTrack.bind(this);\n        this.prevTrack = this.prevTrack.bind(this);\n        this.toggleShuffle = this.toggleShuffle.bind(this);\n        this.handleEnded = this.handleEnded.bind(this);\n      \n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.volume !== this.props.volume) {\n            this.audio.volume = this.props.volume;\n        }\n\n        if (prevProps.currentTrack !== this.props.currentTrack) {\n            clearInterval(this.interval);\n        }\n\n        if (prevProps.currentTrack !== this.props.currentTrack && this.props.currentTrack === undefined) {\n            this.setState({ pause: true });\n            this.audio.pause();\n            clearInterval(this.interval);\n        }\n    }\n\n    componentWillUnmount() {\n        clearInterval(this.interval);\n        this.props.removeEverything();\n    }\n\n    play(e) {\n        e.preventDefault();\n        if (!this.props.currentTrack) return null;\n        this.handleonPlay();\n        this.audio.play();\n    }\n    \n    handleonPlay() {\n        this.setState({ play: true })\n        this.audio.volume = this.props.volume;\n        this.interval = setInterval(() => {\n            if (this.audio) {\n                this.setState({\n                    time: this.audio.currentTime,\n                    duration: this.audio.duration\n                })\n            }\n        }, 500)   \n    }\n\n    handleEnded() {\n        if (this.state.shuffle) {\n            this.props.shuffleTracks();\n        } else if (!this.props.nextTrack) {\n            this.setState({ play: false })\n            this.audio.pause();\n        } else {\n            this.props.nextTrack();\n        }\n    }\n\n    pause(e) {\n        e.preventDefault();\n        this.setState({ play: false })\n        this.audio.pause();\n    }\n\n    nextTrack(e) {\n        e.preventDefault();\n        this.props.nextTrack()\n    }\n\n    prevTrack(e) {\n        e.preventDefault();\n        this.props.prevTrack();\n    }\n\n    updateTime(e) {\n        this.audio.currentTime = e.target.value;\n        this.setState({ time: e.target.value })\n    }\n\n    updateVolume(e) {\n        this.props.changeVolume(e.target.value / 100)\n    }\n\n    toggleRepeat(e) {\n        e.preventDefault();\n        this.setState({ repeat: !this.state.repeat }, () => {\n            this.audio.loop = this.state.repeat;\n        })\n    }\n\n    toggleShuffle(e) {\n        e.preventDefault();\n        this.setState({ shuffle: !this.state.shuffle });\n    }\n\n    toggleMute(e) {\n        this.setState({ mute: !this.state.mute }, () => {\n            if (this.props.volume) this.prevVolume = this.props.volume;\n            if (this.state.mute) {\n                this.props.changeVolume(0);\n                this.audio.volume = 0;\n            } else {\n                this.props.changeVolume(this.prevVolume);\n                this.audio.volume = this.prevVolume;\n            }\n        })\n    }\n\n    parseTime(time) {\n        if (!time) return \"0:00\";\n        let min = Math.floor(time / 60);\n        let seconds = Math.floor(time - (min * 60));\n        if (seconds < 10) seconds = `0${seconds}`;\n        return `${min}:${seconds}`;\n    }\n\n    volumeBtn() {\n        let button;\n        const volume = this.props.volume;\n        if (volume >= 0.5) {\n            button = <i className=\"fas fa-volume-up\"></i>;\n        } else if (volume < 0.5 && volume > 0) {\n            button = <i className=\"fas fa-volume-down\"></i>;\n        } else {\n            button = <i className=\"fas fa-volume-mute\"></i>;\n        }\n\n        return (\n            <div onClick={this.toggleMute} className=\"p-volume-btn\">\n                {button}\n            </div>\n        )\n\n    }\n\n    render() {\n        const playBtn = (\n            <button\n                className=\"p-button-circle\"\n                onClick={this.play}>\n                <i className=\"fas fa-play\"></i>\n            </button>\n        )\n        const pauseBtn = (\n            <button\n                className=\"p-button-circle\"\n                onClick={this.pause}>\n                <i className=\"fas fa-pause\"></i>\n            </button>\n        )\n        \n        const shuffling = this.state.shuffle ? \"-shuffling\" : null;\n        const shuffle = (\n            <button\n                onClick={this.toggleShuffle}\n                className={`p-button-shuffle${shuffling} pbtn`}>\n                <i className=\"fas fa-random\"></i>\n            </button>\n        )\n\n        const active = this.state.repeat ? \"-active\" : null;\n        const repeat = (\n            <button\n                className={`p-button-repeat${active} pbtn`}\n                onClick={this.toggleRepeat}>\n                <i className=\"fas fa-redo\"></i>\n            </button>\n        )\n\n        const prevTrackBtn = (\n            <button\n                onClick={this.prevTrack}\n                className=\"p-button-prev pbtn\">\n                <i className=\"fas fa-step-backward\"></i>\n            </button>\n        )\n\n        const nextTrackBtn = (\n            <button\n                onClick={this.nextTrack}\n                className=\"p-button-fwd pbtn\">\n                <i className=\"fas fa-step-forward\"></i>\n            </button>\n        )\n     \n        const { play, time, duration } = this.state;\n        const { currentTrack } = this.props;\n        return (\n            <div className=\"p-container\">\n                <PlayerInfoContainer shuffle={this.state.shuffle} />\n\n                <div className=\"p-audio-control\">\n                    <div className='p-buttons-container'>\n                        <audio src={currentTrack ? currentTrack.songUrl : null}\n                            ref={audio => this.audio = audio}\n                            onPlay={this.handleonPlay}\n                            onEnded={this.handleEnded}\n                            autoPlay />\n                          {/* {shuffle} */}\n                        {/* {prevTrackBtn} */}\n                        {!play && playBtn}\n                        {play && pauseBtn}\n                        {/* {nextTrackBtn} */}\n                        {/* {repeat} */}\n                    </div>\n\n                    <div className=\"p-timeline-container\">\n                        <span className=\"p-current-time\">\n                            {this.parseTime(time)}\n                        </span>\n                        <input\n                            className=\"p-timeline\"\n                            type=\"range\"\n                            onChange={this.updateTime}\n                            value={time}\n                            max={duration}>\n                        </input>\n\n                        <span className=\"p-duration\">\n                            {this.parseTime(duration)}\n                        </span>\n                    </div>\n                </div>\n\n                <div className=\"p-volume-container\">\n                    <Link to=\"/open/queue\"><div className=\"p-queue-list\">\n                        <i className=\"fas fa-indent\"></i>\n                    </div></Link>\n                    {this.volumeBtn()}\n                    <input\n                        className=\"p-volume\"\n                        type=\"range\"\n                        onChange={this.updateVolume}\n                        value={this.props.volume * 100}\n                        max=\"100\"\n                        style={{\n                            backgroundImage: '-webkit-gradient(linear, left top, right top, '\n                                + 'color-stop(' + this.props.volume + ', #3c02b0), '\n                                + 'color-stop(' + this.props.volume + ', #666666)'\n                                + ')'\n                        }}>\n                    </input>\n                </div>\n\n            </div>\n\n\n\n        )\n    }\n}\n\nexport default Player;\n"]},"metadata":{},"sourceType":"module"}